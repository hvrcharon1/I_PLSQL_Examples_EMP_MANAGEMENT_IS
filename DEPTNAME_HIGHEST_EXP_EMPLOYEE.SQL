SET SERVEROUTPUT ON
DECLARE
  CURSOr DEPTCUR IS
    SELECT DEPARTMENT_ID, DEPARTMENT_NAME FROM DEPARTMENTS WHERE DEPARTMENT_ID IN (SELECT DEPARTMENT_ID FROM EMPLOYEES)
    ORDER BY 2;
 
  V_DEPTID   DEPARTMENTS.DEPARTMENT_ID%TYPE;
  V_DEPTNAME DEPARTMENTS.DEPARTMENT_NAME%TYPE;
  V_NAME     EMPLOYEES.FIRST_NAME%TYPE;
BEGIN

  OPEN DEPTCUR;
  LOOP
     FETCH  DEPTCUR INTO V_DEPTID, V_DEPTNAME;
     EXIT WHEN DEPTCUR%NOTFOUND;
     
     BEGIN 
      -- get employee with hightest experience in this dept
      SELECT FIRST_NAME INTO V_NAME FROM EMPLOYEES WHERE DEPARTMENT_ID = V_DEPTID AND HIRE_DATE = (SELECT MIN(HIRE_DATE) FROM EMPLOYEES 
      WHERE DEPARTMENT_ID = V_DEPTID );
        
      DBMS_OUTPUT.PUT_LINE(V_DEPTNAME || ' '  || V_NAME);
     EXCEPTION
       WHEN TOO_MANY_ROWS THEN
          DBMS_OUTPUT.PUT_LINE(V_DEPTNAME || ' is having more than one employee');   
     END;
     
  END LOOP;
  CLOSE DEPTCUR;

END;  
 
With Cursor For Loop
====================
SET SERVEROUTPUT ON
DECLARE
  CURSOR DEPTCUR IS
    SELECT DEPARTMENT_ID, DEPARTMENT_NAME FROM DEPARTMENTS WHERE DEPARTMENT_ID IN (SELECT DEPARTMENT_ID FROM EMPLOYEES)
    ORDER BY 2;
   V_NAME     EMPLOYEES.FIRST_NAME%TYPE;
BEGIN
  FOR DEPTREC IN DEPTCUR
  LOOP
     BEGIN 
      -- get employee with hightest experience in this dept
      SELECT FIRST_NAME INTO V_NAME from EMPLOYEES WHERE  DEPARTMENT_ID =  DEPTREC.DEPARTMENT_ID AND HIRE_DATE =  (SELECT MIN(HIRE_DATE)  from employees 
        WHERE DEPARTMENT_ID =  DEPTREC.DEPARTMENT_ID );
        
      DBMS_OUTPUT.PUT_LINE(DEPTREC.DEPARTMENT_NAME || ' '  || V_NAME);
     EXCEPTION
       WHEN TOO_MANY_ROWS THEN
        DBMS_OUTPUT.PUT_LINE(DEPTREC.DEPARTMENT_NAME || ' is having more than one employee');   
     END;
   END LOOP;
END;  
 
